## DBMS初探

## 数据库相关的存储结构

部件|作用
----:|:---
查询编辑器|对查询进行分析和优化，得到查询计划或DBMS，用来传给执行引擎
执行引擎|向**资源管理器** 发出一系列小的数据单元（记录或关系的元组）的请求
资源管理器|掌握着存放关系的数据文件、文件中的数据格式和记录大小，以及支持对于数据文件中的元素进行快速查找的索引文件。**执行引擎对资源管理器的请求就是对索引、文件、记录管理器的请求**
缓冲区管理器|查询请求会进一步发送到缓冲区管理器，**从持久存储数据的辅助存储器（一般是磁盘）中将数据的适当部分取到主存的缓冲区**。缓冲区和磁盘间的传输单位是也或”磁盘块“
存储管理器|控制数据在磁盘上的放置和在磁盘与主存之间的移动

### 查询处理器

1、**查询编辑器**
[查询编辑器]将查询翻译成一种内部形式，称作查询计划。

查询编辑器由一下三部分组成

- **查询分析器**，他有本文形式的查询出发，建立一个树结构
- **查询预处理器**，他对查询进行语义检查（eg. 检查查询中所提到的关系是否都确实存在），并进行某些树结构转换，将分析书转换为表示最初的查询计划的代数操作树。
- **查询优化器**，他将最初的查询计划转换为对于时间数据的最有效的操作序列.

2、**执行引擎**
[执行引擎]负责执行选中的查询计划中的每一步。与DBMS中大多数的其他成分都有交互（直接交互或者通过缓冲区交互）。
- 通过缓冲区。对数据的的操作，必须将数据库的数据取到缓冲区。
- 和调度器的交互，为了避免访问被加了锁的数据
- 和日志管理器进行交互，用一确保对于数据库的所有修改都正确的记录了日志。



### 辅助存储器

**一般都是磁盘**

1、**存储器的层次**
一般有四种，响应速度由高到低依次是

存储器|作用|相应时间
:---|:---|:---
高速缓存（Cache）|当处理器需要【数据】和【指令】时，数据和指令就会从【内存】移动到告诉缓存|处理器访问Cache只需要几ns
主存（Main Memory）|主存是计算机的活动中心。发生在计算机的每一件事情，不论是指令执行还是数据操作，都是作用于驻留在内存的信息上（*尽管实际上通常会将所使用的数据移动到Cache中*）|内存到处理器或Cache的速度在10~100ns
辅助存储器|一般是磁盘|磁盘和主存传送一个字节时间大约为10ms
第三季存储器|例如CD，DVD|几秒到几分钟

2、**辅助存储器-磁盘**
- 磁头组合
	磁头组合承载着磁头，磁头急近的悬浮在盘面上（磁盘的上下两个面），但是不能接触到盘面，不然盘片会被损毁。

- 磁盘组合，又一个或多个同心圆盘组合，围绕一个中心主轴转动
- 磁道
	一个磁盘有个下两个面，每个面有很多磁道。所有盘面半径相同的磁道构成了柱面。
	
- 扇区 每个磁道被【间隙(gap)】分成多个扇区，可以理解为扇区就是一段圆弧。

2.1、**磁盘控制器**
磁盘控制器是一个小的处理器，负责的任务
1）控制磁头的机械马达（叫机器手臂是不是更好？），将磁头定位到一个半径的位置。这样就能读取到一个柱面的任何数据（因为每个盘片的上下两个面都有磁头，所以是一个柱面上的数据都能读取到）
2）从磁头所在的柱面的扇区中选择一个扇区。除此之外，还能识别合适旋转主轴到达了磁头需要读取的那个点。
3）将从扇区读取的数据传送到主存
4）如果可以，将一条或更多磁道缓存于【磁盘控制器的内存】中，避免磁盘额外访问
3.